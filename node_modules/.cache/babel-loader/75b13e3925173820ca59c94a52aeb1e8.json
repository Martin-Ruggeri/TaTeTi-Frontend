{"ast":null,"code":"var _jsxFileName = \"/home/martin/Programas/React/tateti_v1.1/src/game/board/board.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router';\nimport './boardStyle.css';\nimport { getGame } from '../gameApi';\nimport { newBoard, editBoard, getBoard } from './boardApi';\nconst gameInit = {\n  id: 0,\n  vsMaquina: false,\n  winUser1: 0,\n  winUser2: 0,\n  user1: {\n    id: 0,\n    name: '',\n    token: ''\n  },\n  user2: {\n    id: 0,\n    name: '',\n    token: ''\n  }\n};\n\nfunction Board() {\n  // HOOKS\n  const [board, setBoard] = useState({});\n  const [game, setGame] = useState(gameInit);\n  const {\n    idGame\n  } = useParams();\n\n  async function handleSelecCasilla(casilla) {\n    if (board.win) return; // Si ya hay ganador, no hacer nada\n\n    const body = {\n      casilla: casilla\n    };\n    setBoard(await editBoard(game.id, board.id, body));\n  }\n\n  async function handleRevencha() {\n    if (!board.win) return; // Si el juego todavia no termina, no hacer nada  => SE DEBE MOSTRAR MENSAJE \"Para jugar revancha se debe terminar el juego\"\n\n    await newBoard(game.id, {}); // Crea un nuevo tablero\n  }\n\n  function marcar(i) {\n    if (!board.casillas) return;\n    if (board.casillas[i] === game.user1.token) return 'X';\n    if (board.casillas[i] === game.user2.token) return 'O';\n    return;\n  }\n\n  useEffect(() => {\n    async function buscarJuego() {\n      const restGame = await getGame(idGame);\n      setGame(restGame); // Tanto el setGame como el setBoard, se tardan X tiempo en cargarse, por lo que para usarse en las siguientes lineas debe ser atraves de una variable comun. Ej: resGame o resBoard\n\n      const resBoard = await getBoard(idGame, restGame.ultBoard ? restGame.ultBoard : 0);\n      setBoard(resBoard);\n    }\n\n    let interval = setInterval(() => buscarJuego(), 1000);\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"grid-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Users, {\n    board: board,\n    game: game,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    id: \"tablero\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c1\",\n    onClick: () => handleSelecCasilla(0),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 25\n    }\n  }, marcar(0), \" \"), \"         \", /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c2\",\n    onClick: () => handleSelecCasilla(1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 25\n    }\n  }, marcar(1)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c3\",\n    onClick: () => handleSelecCasilla(2),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 25\n    }\n  }, marcar(2))), /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c1\",\n    onClick: () => handleSelecCasilla(3),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 25\n    }\n  }, marcar(3)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c2\",\n    onClick: () => handleSelecCasilla(4),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 25\n    }\n  }, marcar(4)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c3\",\n    onClick: () => handleSelecCasilla(5),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 25\n    }\n  }, marcar(5))), /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c1\",\n    onClick: () => handleSelecCasilla(6),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 25\n    }\n  }, marcar(6)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c2\",\n    onClick: () => handleSelecCasilla(7),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 25\n    }\n  }, marcar(7)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c3\",\n    onClick: () => handleSelecCasilla(8),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 25\n    }\n  }, marcar(8))))), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"w3-button w3-black w3-round-xlarge w3-small revancha\",\n    onClick: () => handleRevencha(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 13\n    }\n  }, \"Revancha\"));\n}\n\nfunction Users(props) {\n  // HOOKS\n  const {\n    idGame\n  } = useParams();\n  const [game, setGame] = useState({});\n  const [board, setBoard] = useState({});\n  const [user1, setUser1] = useState({});\n  const [user2, setUser2] = useState({});\n  useEffect(() => {\n    console.log(props);\n    /*\n    async function buscarUsers() {\n        const resGame = await getGame(idGame);\n        setGame(game);\n        setBoard(await getBoard(idGame, resGame.ultBoard ? resGame.ultBoard : 0));\n         setUser1(resGame.user1);\n        setUser2(resGame.user2);\n    }\n     buscarUsers();\n    */\n\n    if (props.game != {}) console.log(\"hp√±a\"); //setUser1(props.game.user1);\n    //if(props.game)setUser2(props.game.user2);\n  });\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-user\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-card-4 w3-col l3 w3-margin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"partidasGanadas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 21\n    }\n  }, \"Partidas ganadas: \", game.winUser1)), /*#__PURE__*/React.createElement(\"header\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 21\n    }\n  }, user1.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 21\n    }\n  }, \" Tienes las 'X'\")), /*#__PURE__*/React.createElement(\"footer\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 21\n    }\n  }, board.turno === user1.token && 'Tu turno'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-card-4 w3-col l3 w3-margin w3-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"partidasGanadas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 21\n    }\n  }, \"Partidas ganadas: \", game.winUser2)), /*#__PURE__*/React.createElement(\"header\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 157,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 158,\n      columnNumber: 21\n    }\n  }, user2.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 161,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 21\n    }\n  }, \" Tienes los 'O'\")), /*#__PURE__*/React.createElement(\"footer\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 21\n    }\n  }, board.turno === user2.token && 'Tu turno'))));\n}\n\nexport { Board, Users };","map":{"version":3,"sources":["/home/martin/Programas/React/tateti_v1.1/src/game/board/board.tsx"],"names":["React","useState","useEffect","useParams","getGame","newBoard","editBoard","getBoard","gameInit","id","vsMaquina","winUser1","winUser2","user1","name","token","user2","Board","board","setBoard","game","setGame","idGame","handleSelecCasilla","casilla","win","body","handleRevencha","marcar","i","casillas","buscarJuego","restGame","resBoard","ultBoard","interval","setInterval","clearInterval","Users","props","setUser1","setUser2","console","log","turno"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useParams } from 'react-router';\nimport './boardStyle.css';\n\nimport { IUser } from '../../user/userApi';\nimport { IGame, getGame } from '../gameApi';\nimport { IBoard, IUpDateBoard, newBoard, editBoard, getBoard } from './boardApi';\n\nconst gameInit : IGame = {id:0, vsMaquina: false, winUser1:0, winUser2:0, user1: {id:0 , name:'', token:''}, user2: {id:0 , name:'', token:''}   }\n\nfunction Board() {\n    // HOOKS\n    const [board, setBoard] = useState({} as IBoard);\n    const [game, setGame] = useState(gameInit);\n    const { idGame } = useParams();\n\n\n\n    async function handleSelecCasilla(casilla: number) {\n\n        if (board.win) return;       // Si ya hay ganador, no hacer nada\n\n        const body: IUpDateBoard = { casilla: casilla }\n        setBoard(await editBoard(game.id, board.id, body));\n    }\n\n    async function handleRevencha() {\n\n        if (!board.win) return; // Si el juego todavia no termina, no hacer nada  => SE DEBE MOSTRAR MENSAJE \"Para jugar revancha se debe terminar el juego\"\n\n\n        await newBoard(game.id, {});    // Crea un nuevo tablero\n    }\n\n\n    function marcar(i: number) {\n        if (!board.casillas) return;\n\n        if (board.casillas[i] === game.user1.token) return 'X';\n        if (board.casillas[i] === game.user2.token) return 'O';\n\n        return;\n    }\n\n\n    useEffect(() => {\n\n        async function buscarJuego() {\n            const restGame = await getGame(idGame)\n            setGame(restGame);                      // Tanto el setGame como el setBoard, se tardan X tiempo en cargarse, por lo que para usarse en las siguientes lineas debe ser atraves de una variable comun. Ej: resGame o resBoard\n            const resBoard = await getBoard(idGame, restGame.ultBoard ? restGame.ultBoard : 0);\n            setBoard(resBoard);\n\n        }\n\n        let interval = setInterval(\n            () => buscarJuego(),\n            1000\n        );\n\n        return (() => {\n            clearInterval(interval);\n        })\n    }, []);\n\n\n    return (\n        <div className=\"grid-container\">\n\n            <Users board={board} game={game}/>\n\n            <table id=\"tablero\">\n                <tbody>\n                    <tr>\n                        <td className=\"f1 c1\" onClick={() => handleSelecCasilla(0)} >{marcar(0)} </td>         {/*  { board.casillas && board.casillas[0] === game.user1 ? 'X' : 'O' }  */}\n                        <td className=\"f1 c2\" onClick={() => handleSelecCasilla(1)} >{marcar(1)}</td>\n                        <td className=\"f1 c3\" onClick={() => handleSelecCasilla(2)} >{marcar(2)}</td>\n                    </tr>\n                    <tr>\n                        <td className=\"f2 c1\" onClick={() => handleSelecCasilla(3)} >{marcar(3)}</td>\n                        <td className=\"f2 c2\" onClick={() => handleSelecCasilla(4)} >{marcar(4)}</td>\n                        <td className=\"f2 c3\" onClick={() => handleSelecCasilla(5)} >{marcar(5)}</td>\n                    </tr>\n                    <tr>\n                        <td className=\"f3 c1\" onClick={() => handleSelecCasilla(6)} >{marcar(6)}</td>\n                        <td className=\"f3 c2\" onClick={() => handleSelecCasilla(7)} >{marcar(7)}</td>\n                        <td className=\"f3 c3\" onClick={() => handleSelecCasilla(8)} >{marcar(8)}</td>\n                    </tr>\n                </tbody>\n            </table>\n\n            <button className=\"w3-button w3-black w3-round-xlarge w3-small revancha\" onClick={() => handleRevencha()} >Revancha</button>\n        </div>\n    );\n}\n\ninterface IpropsUsers{\n    board: IBoard,\n    game: IGame,\n}\n\nfunction Users(props:IpropsUsers) {\n    // HOOKS\n    const { idGame } = useParams();\n    const [game, setGame] = useState({} as IGame);\n    const [board, setBoard] = useState({} as IBoard);\n    const [user1, setUser1] = useState({} as IUser);\n    const [user2, setUser2] = useState({} as IUser);\n\n\n\n    useEffect(() => {\n        console.log(props)\n        /*\n        async function buscarUsers() {\n            const resGame = await getGame(idGame);\n            setGame(game);\n            setBoard(await getBoard(idGame, resGame.ultBoard ? resGame.ultBoard : 0));\n\n            setUser1(resGame.user1);\n            setUser2(resGame.user2);\n        }\n\n        buscarUsers();\n        */\n\n        if(props.game != {} as IGame) console.log(\"hp√±a\");//setUser1(props.game.user1);\n        //if(props.game)setUser2(props.game.user2);\n\n    },);\n\n    return (\n        <div className=\"container-user\">\n            {/* User 1 */}\n            <div className=\"w3-card-4 w3-col l3 w3-margin\">\n                <div className=\"partidasGanadas\">\n                    <label>Partidas ganadas: {game.winUser1}</label>\n                </div>\n                <header className=\"w3-container w3-blue\">\n                    <h2>{user1.name}</h2>\n                </header>\n\n                <div className=\"w3-container\">\n                    <p> Tienes las 'X'</p>\n                </div>\n\n                <footer className=\"w3-container w3-blue\">\n                    <h5>{board.turno === user1.token && 'Tu turno'}</h5>\n                </footer>\n            </div>\n\n            {/* User 2 */}\n            <div className=\"w3-card-4 w3-col l3 w3-margin w3-right\">\n                <div className=\"partidasGanadas\">\n                    <label>Partidas ganadas: {game.winUser2}</label>\n                </div>\n                <header className=\"w3-container w3-blue\">\n                    <h2>{user2.name}</h2>\n                </header>\n\n                <div className=\"w3-container\">\n                    <p> Tienes los 'O'</p>\n                </div>\n\n                <footer className=\"w3-container w3-blue\">\n                    <h5>{board.turno === user2.token && 'Tu turno'}</h5>\n                </footer>\n            </div>\n\n        </div>\n    );\n}\n\n\nexport { Board, Users };\n\n"]},"metadata":{},"sourceType":"module"}