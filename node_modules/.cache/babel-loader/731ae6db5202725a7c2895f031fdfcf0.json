{"ast":null,"code":"var _jsxFileName = \"/home/martin/Programas/React/tateti_v1.1/src/game/board/board.tsx\";\nimport React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router';\nimport './boardStyle.css';\nimport { getGame } from '../gameApi';\nimport { newBoard, editBoard, getBoard } from './boardApi';\nconst recargaCada = 1000;\nconst boardInit = {\n  id: 0,\n  turno: '',\n  casillas: ['0', '0', '0', '0', '0', '0', '0', '0', '0']\n};\n\nfunction Board() {\n  // HOOKS\n  const history = useHistory();\n  const {\n    gameInit\n  } = history.location.state;\n  const [game, setGame] = useState(gameInit);\n  const [board, setBoard] = useState(boardInit);\n  const [validation, setValidation] = useState('');\n\n  async function handleSelecCasilla(casilla) {\n    if (board.win) {\n      setValidation(`Game over`);\n      return;\n    } // Si ya hay ganador, no hacer nada\n\n\n    try {\n      const body = {\n        casilla: casilla\n      }; // Actualiza el Board\n\n      setBoard(await editBoard(game.id, board.id, body));\n    } catch (error) {\n      setValidation(`${error}`);\n    }\n  }\n\n  async function handleRevencha() {\n    if (!board.win) return; // Si el juego todavia no termina, no hacer nada  => SE DEBE MOSTRAR MENSAJE \"Para jugar revancha se debe terminar el juego\"\n\n    await newBoard(game.id, {}); // Crea un nuevo tablero\n  }\n\n  function marcar(i) {\n    if (!board.casillas) return;\n    if (!game) return;\n    if (board.casillas[i] === game.user1.token) return 'X';\n    if (board.casillas[i] === game.user2.token) return 'O';\n    return;\n  }\n\n  useEffect(() => {\n    async function buscarJuego() {\n      const restGame = await getGame(game.id); // Al hacer setGame, en las lineas siguientes no se puede usar game, por eso se guarda resGame en una constante\n\n      setGame(restGame);\n      setBoard(await getBoard(game.id, restGame.ultBoard ? restGame.ultBoard : 0));\n    }\n\n    let interval = setInterval(() => buscarJuego(), // Esta funcion actualiza el game y el board\n    recargaCada);\n    return () => {\n      clearInterval(interval);\n    };\n  }, [game.id]);\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"grid-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Users, {\n    board: board,\n    game: game,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 13\n    }\n  }), /*#__PURE__*/React.createElement(\"table\", {\n    id: \"tablero\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"tbody\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c1\",\n    onClick: () => handleSelecCasilla(0),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 25\n    }\n  }, marcar(0)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c2\",\n    onClick: () => handleSelecCasilla(1),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 25\n    }\n  }, marcar(1)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f1 c3\",\n    onClick: () => handleSelecCasilla(2),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 25\n    }\n  }, marcar(2))), /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c1\",\n    onClick: () => handleSelecCasilla(3),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87,\n      columnNumber: 25\n    }\n  }, marcar(3)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c2\",\n    onClick: () => handleSelecCasilla(4),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88,\n      columnNumber: 25\n    }\n  }, marcar(4)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f2 c3\",\n    onClick: () => handleSelecCasilla(5),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 25\n    }\n  }, marcar(5))), /*#__PURE__*/React.createElement(\"tr\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91,\n      columnNumber: 21\n    }\n  }, /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c1\",\n    onClick: () => handleSelecCasilla(6),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 92,\n      columnNumber: 25\n    }\n  }, marcar(6)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c2\",\n    onClick: () => handleSelecCasilla(7),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 25\n    }\n  }, marcar(7)), /*#__PURE__*/React.createElement(\"td\", {\n    className: \"f3 c3\",\n    onClick: () => handleSelecCasilla(8),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 25\n    }\n  }, marcar(8))))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-pale-red w3-border w3-text-red\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101,\n      columnNumber: 17\n    }\n  }, validation)), /*#__PURE__*/React.createElement(\"button\", {\n    className: \"w3-button w3-black w3-round-xlarge w3-small revancha\",\n    onClick: () => handleRevencha(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104,\n      columnNumber: 13\n    }\n  }, \"Revancha\"));\n}\n\nfunction Users(props) {\n  return /*#__PURE__*/React.createElement(\"div\", {\n    className: \"container-user\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-card-4 w3-col l3 w3-margin\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"partidasGanadas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 21\n    }\n  }, \"Partidas ganadas: \", props.game.winUser1)), /*#__PURE__*/React.createElement(\"header\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124,\n      columnNumber: 21\n    }\n  }, props.game.user1.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 127,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 128,\n      columnNumber: 21\n    }\n  }, \" Tienes las 'X'\")), /*#__PURE__*/React.createElement(\"footer\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 21\n    }\n  }, props.board.turno === props.game.user1.token && 'Tu turno'))), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-card-4 w3-col l3 w3-margin w3-right\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(\"div\", {\n    className: \"partidasGanadas\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"label\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139,\n      columnNumber: 21\n    }\n  }, \"Partidas ganadas: \", props.game.winUser2)), /*#__PURE__*/React.createElement(\"header\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h2\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 21\n    }\n  }, props.game.user2.name)), /*#__PURE__*/React.createElement(\"div\", {\n    className: \"w3-container\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 145,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"p\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 146,\n      columnNumber: 21\n    }\n  }, \" Tienes los 'O'\")), /*#__PURE__*/React.createElement(\"footer\", {\n    className: \"w3-container w3-blue\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 21\n    }\n  }, props.board.turno === props.game.user2.token && 'Tu turno'))));\n}\n\nexport { Board, Users };","map":{"version":3,"sources":["/home/martin/Programas/React/tateti_v1.1/src/game/board/board.tsx"],"names":["React","useState","useEffect","useHistory","getGame","newBoard","editBoard","getBoard","recargaCada","boardInit","id","turno","casillas","Board","history","gameInit","location","state","game","setGame","board","setBoard","validation","setValidation","handleSelecCasilla","casilla","win","body","error","handleRevencha","marcar","i","user1","token","user2","buscarJuego","restGame","ultBoard","interval","setInterval","clearInterval","Users","props","winUser1","name","winUser2"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useHistory } from 'react-router';\nimport './boardStyle.css';\n\nimport { IGame, getGame } from '../gameApi';\nimport { IBoard, IUpDateBoard, newBoard, editBoard, getBoard } from './boardApi';\n\nconst recargaCada: number = 1000;\nconst boardInit: IBoard = { id: 0, turno: '', casillas: ['0', '0', '0', '0', '0', '0', '0', '0', '0'] }\n\nfunction Board() {\n    // HOOKS\n    const history = useHistory();\n    const { gameInit }: any = history.location.state;\n    const [game, setGame] = useState(gameInit);\n    const [board, setBoard] = useState(boardInit);\n    const [validation, setValidation] = useState('');\n\n\n\n    async function handleSelecCasilla(casilla: number) {\n        if (board.win) {\n            setValidation(`Game over`);    \n            return;\n        }       // Si ya hay ganador, no hacer nada\n\n        try {\n            const body: IUpDateBoard = { casilla: casilla }     // Actualiza el Board\n            setBoard(await editBoard(game.id, board.id, body));\n        } catch (error) {\n            setValidation(`${error}`);   \n        }\n    }\n\n\n    async function handleRevencha() {\n        if (!board.win) return; // Si el juego todavia no termina, no hacer nada  => SE DEBE MOSTRAR MENSAJE \"Para jugar revancha se debe terminar el juego\"\n\n        await newBoard(game.id, {});    // Crea un nuevo tablero\n    }\n\n\n    function marcar(i: number) {\n        if (!board.casillas) return;\n        if (!game) return;\n\n\n        if (board.casillas[i] === game.user1.token) return 'X';\n        if (board.casillas[i] === game.user2.token) return 'O';\n\n        return;\n    }\n\n\n    useEffect(() => {\n\n        async function buscarJuego() {\n            const restGame = await getGame(game.id);    // Al hacer setGame, en las lineas siguientes no se puede usar game, por eso se guarda resGame en una constante\n            setGame(restGame);\n            setBoard(await getBoard(game.id, restGame.ultBoard ? restGame.ultBoard : 0));\n        }\n\n        let interval = setInterval(\n            () => buscarJuego(),        // Esta funcion actualiza el game y el board\n            recargaCada\n        );\n\n        return (() => {\n            clearInterval(interval);\n        })\n    }, [game.id]);\n\n\n    return (\n        <div className=\"grid-container\">\n\n            <Users board={board} game={game} />\n\n            <table id=\"tablero\">\n                <tbody>\n                    <tr>\n                        <td className=\"f1 c1\" onClick={() => handleSelecCasilla(0)} >{marcar(0)}</td>\n                        <td className=\"f1 c2\" onClick={() => handleSelecCasilla(1)} >{marcar(1)}</td>\n                        <td className=\"f1 c3\" onClick={() => handleSelecCasilla(2)} >{marcar(2)}</td>\n                    </tr>\n                    <tr>\n                        <td className=\"f2 c1\" onClick={() => handleSelecCasilla(3)} >{marcar(3)}</td>\n                        <td className=\"f2 c2\" onClick={() => handleSelecCasilla(4)} >{marcar(4)}</td>\n                        <td className=\"f2 c3\" onClick={() => handleSelecCasilla(5)} >{marcar(5)}</td>\n                    </tr>\n                    <tr>\n                        <td className=\"f3 c1\" onClick={() => handleSelecCasilla(6)} >{marcar(6)}</td>\n                        <td className=\"f3 c2\" onClick={() => handleSelecCasilla(7)} >{marcar(7)}</td>\n                        <td className=\"f3 c3\" onClick={() => handleSelecCasilla(8)} >{marcar(8)}</td>\n                    </tr>\n                </tbody>\n            </table>\n\n            {/* Validaciones */}\n            <div className=\"w3-pale-red w3-border w3-text-red\">\n                <label>{validation}</label>\n            </div>\n\n            <button className=\"w3-button w3-black w3-round-xlarge w3-small revancha\" onClick={() => handleRevencha()} >Revancha</button>\n        </div>\n    );\n}\n\ninterface IpropsUsers {\n    board: IBoard,\n    game: IGame,\n}\n\nfunction Users(props: IpropsUsers) {\n\n    return (\n        <div className=\"container-user\">\n            {/* User 1 */}\n            <div className=\"w3-card-4 w3-col l3 w3-margin\">\n                <div className=\"partidasGanadas\">\n                    <label>Partidas ganadas: {props.game.winUser1}</label>\n                </div>\n                <header className=\"w3-container w3-blue\">\n                    <h2>{props.game.user1.name}</h2>\n                </header>\n\n                <div className=\"w3-container\">\n                    <p> Tienes las 'X'</p>\n                </div>\n\n                <footer className=\"w3-container w3-blue\">\n                    <h5>{props.board.turno === props.game.user1.token && 'Tu turno'}</h5>\n                </footer>\n            </div>\n\n            {/* User 2 */}\n            <div className=\"w3-card-4 w3-col l3 w3-margin w3-right\">\n                <div className=\"partidasGanadas\">\n                    <label>Partidas ganadas: {props.game.winUser2}</label>\n                </div>\n                <header className=\"w3-container w3-blue\">\n                    <h2>{props.game.user2.name}</h2>\n                </header>\n\n                <div className=\"w3-container\">\n                    <p> Tienes los 'O'</p>\n                </div>\n\n                <footer className=\"w3-container w3-blue\">\n                    <h5>{props.board.turno === props.game.user2.token && 'Tu turno'}</h5>\n                </footer>\n            </div>\n\n        </div>\n    );\n}\n\n\nexport { Board, Users };\n\n"]},"metadata":{},"sourceType":"module"}